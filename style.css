document.addEventListener("DOMContentLoaded", function () {
  const spinButton = document.getElementById("spinButton");
  const roulette = document.getElementById("roulette");
  const resultDisplay = document.getElementById("result");

  let isSpinning = false;
  let totalFunds = 100000; // Fondos mensuales disponibles
  let prizes = [
    { amount: 20000, text: "20,000 pesos" },
    { amount: 10000, text: "10,000 pesos" },
    { amount: 5000, text: "5,000 pesos" },
    { amount: 2000, text: "2,000 pesos" },
    { amount: 1000, text: "1,000 pesos" },
    { amount: 0, text: "Vuelve maÃ±ana ðŸ˜Œ" }
  ];

  spinButton.addEventListener("click", function () {
    if (isSpinning) return;
    isSpinning = true;

    let randomIndex = Math.floor(Math.random() * prizes.length);
    let selectedPrize = prizes[randomIndex];

    // Si el premio excede los fondos disponibles, elegir otro
    while (selectedPrize.amount > totalFunds && selectedPrize.amount !== 0) {
      randomIndex = Math.floor(Math.random() * prizes.length);
      selectedPrize = prizes[randomIndex];
    }

    // RotaciÃ³n aleatoria entre 360 y 1440 grados
    let randomRotation = 3600 + randomIndex * 60;
    roulette.style.transform = `rotate(${randomRotation}deg)`;

    setTimeout(() => {
      if (selectedPrize.amount > 0) {
        totalFunds -= selectedPrize.amount;
        showCelebration();
        resultDisplay.textContent = `Â¡Felicidades! Has ganado ${selectedPrize.text}! ðŸŽ‰`;
        resultDisplay.classList.add("result-won");
      } else {
        resultDisplay.textContent = selectedPrize.text;
        resultDisplay.classList.add("result-lost");
      }

      isSpinning = false;
    }, 7000);
  });

  function showCelebration() {
    for (let i = 0; i < 50; i++) {
      let confetti = document.createElement("div");
      confetti.classList.add("confetti");
      confetti.style.left = `${Math.random() * 100}vw`;
      confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
      document.body.appendChild(confetti);

      setTimeout(() => confetti.remove(), 5000);
    }
  }
});
